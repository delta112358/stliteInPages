<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>stlite localStorage Test</title>
    <!-- Using stlite version 0.50.0 -->
    <script src="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.50.0/build/stlite.js"></script>
  </head>

  <body>
    <div id="root"></div>

    <script>
      stlite.mount(
        {
          requirements: ["streamlit-javascript"], 
          entrypoint: "streamlit_app.py", 
          files: {
            "streamlit_app.py": `
import streamlit as st
from streamlit_javascript import st_javascript

st.title("Stlite localStorage Test")
js_command_get = "await Promise.resolve(window.parent.localStorage.getItem('my_stlite_key'))"

st.subheader("Current Saved Value:")

current_value = st_javascript(js_command_get)
if current_value is None:
    st.write("No value is currently set in localStorage for 'my_stlite_key'.")
else:
    st.write(current_value)

value_to_save = st.text_input("Value")
if st.button("Save"):
    js_command_set = f"await Promise.resolve(window.parent.localStorage.setItem('my_stlite_key', '{value_to_save}'));"
    st_javascript(js_command_set)
    st.rerun()
`
          },
        },
        document.getElementById("root")
      );
    </script>
  </body>
</html>


